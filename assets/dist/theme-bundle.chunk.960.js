"use strict";(self.webpackChunkWebpackChiara=self.webpackChunkWebpackChiara||[]).push([[960],{25960:(t,e,a)=>{a.r(e),a.d(e,{default:()=>h});var i=a(23279),r=a.n(i),n=a(95440),o=a.n(n),d=a(466),s=a.n(d),c=a(55825);function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}const l=function(){function t(t){var e=t.$scope,a=t.$attributesContainer,i=t.productId,r=t.productViewFile,n=t.attributesTemplate,o=t.templateCustomTags,d=t.addToCartFormSelector,s=t.$cardImage,c=t.imageSize,u=t.inputFinderFunc,l=t.swatchesLimit,p=t.imageReplacerFunc,h=t.displayInStockOnly,m=t.autoSelectOptionValues,f=t.autoInit,v=void 0===f||f,g=t.graphQLNode;this.$scope=e,this.productId=i,this.$attributesContainer=a,this.productViewFile=r,this.attributesTemplate=n,this.templateCustomTags=o,this.addToCartFormSelector=d,this.$cardImage=s,this.imageSize=c,this.inputFinderFunc=u,this.swatchesLimit=l,this.imageReplacerFunc=p,this.displayInStockOnly=h,this.autoSelectOptionValues=m,this.autoInit=v,this.graphQLNode=g,this.autoInit&&this.init()}var e=t.prototype;return e.init=function(){this.displayInStockOnly?this.requestInStockAttributes():this.graphQLNode?this.buildProductOptions():this.requestProductOptions()},e.requestInStockAttributes=function(){var t=this;c.ajax({url:"/remote/v1/product-attributes/"+this.productId,method:"POST",data:{action:"add",product_id:this.productId},headers:{"stencil-config":"{}","stencil-options":"{}","x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""},xhrFields:{withCredentials:!0},success:function(e){var a=e.data||{};("object"==typeof a.in_stock_attributes||a.instock)&&(t.graphQLNode?t.buildProductOptions(a):t.requestProductOptions(a))}})},e.requestProductOptions=function(t){var e=this;c.ajax({url:"/products.php?productId="+this.productId,method:"GET",headers:{"stencil-config":"{}","stencil-options":'{"render_with":"'+this.productViewFile+'"}',"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""},xhrFields:{withCredentials:!0},success:function(a){e.buildProductOptions(t,a)}})},e.buildProductOptions=function(t,e){var a=this;void 0===t&&(t={});var i={attributes:[]};if(this.graphQLNode?i.attributes=this.graphQLNode.productOptions.edges.reduce((function(e,a){var i=a.node;if(i.values){var r=i.values.edges.reduce((function(e,a){var r=a.node;return("object"!=typeof t.in_stock_attributes||t.in_stock_attributes.indexOf(r.entityId)>-1)&&(r.imageUrl||r.hexColors)&&e.push({content:r.imageUrl?'<span class="form-option-variant form-option-variant--pattern" title="'+r.label+'" style="background-image: url(\''+r.imageUrl+"');\"></span>":r.hexColors.map((function(t){return"<span class='form-option-variant form-option-variant--color' title=\""+r.label+'" style="background-color: '+t+'"></span>'})).join(""),label:r.label,attributeId:i.entityId,attributeValue:r.entityId}),e}),[]);r.length>0&&e.push(r)}return e}),[]):c(e).find('[data-product-attribute="swatch"]').each((function(e,r){var n=c(r),o=[];n.find("[data-product-attribute-value]").each((function(e,i){var r=c(i),d=a.inputFinderFunc?a.inputFinderFunc(n,r):n.find('[id="'+r.attr("for")+'"]'),s=Number(d.attr("value")),u=Number(d.attr("name").replace(/attribute\[([0-9]+)\]/,"$1"));("object"!=typeof t.in_stock_attributes||t.in_stock_attributes.indexOf(s)>-1)&&o.push({content:r.html(),label:d.data("productAttributeLabel"),attributeId:u,attributeValue:s})})),o.length>0&&i.attributes.push(o)})),0!==i.attributes.length){var r,n=s().render(this.attributesTemplate,i,null,this.templateCustomTags);this.$attributesContainer.append(n),this.graphQLNode?((r=c('<form class="productSwatches-hiddenForm"></form>').hide()).append('<input type="hidden" name="action" value="add">'),r.append('<input type="hidden" name="product_id" value="'+this.productId+'">'),r.append('<input type="hidden" name="qty[]" value="'+(this.graphQLNode.minPurchaseQuantity||1)+'">'),this.graphQLNode.productOptions.edges.forEach((function(e){var i=e.node,n="";i.values?(n=a.autoSelectOptionValues&&i.values.edges.length>0?i.values.edges[0].node.entityId:"",!(n=i.values.edges.reduce((function(t,e){var a=e.node;return a.isDefault?a.entityId:t}),n))&&t&&t.in_stock_attributes&&(n=i.values.edges.reduce((function(e,a){var i=a.node;return e||(t.in_stock_attributes.indexOf(i.entityId)>-1?i.entityId:"")}),""))):i.checkedByDefault&&(n=1),r.append('<input type="hidden" name="attribute['+i.entityId+']" value="'+n+'">')}))):c("<div></div>").append(e).find(this.addToCartFormSelector).addClass("productSwatches-hiddenForm").hide().find("[id]").prop("id",null),this.$attributesContainer.append(r),this.$attributesContainer.on("click","[data-attribute-id]",(function(t){t.preventDefault();var e=c(t.currentTarget),i=e.data("attributeId"),n=e.data("attributeValue");a.$attributesContainer.find("[data-attribute-id="+i+"]").removeClass("is-active").find("input").prop("checked",!1),e.addClass("is-active").find("input").prop("checked",!0),r.find('[name="attribute['+i+']"]').val([n]),a.requestAttributesChange(r)})),this.swatchesLimit?this.$attributesContainer.find("[data-more]").each((function(t,e){var i=c(e),r=i.closest("[data-swatches]"),n=r.find("[data-less]"),o=r.find("[data-attribute-id]");if(o.length>a.swatchesLimit){var d=o.filter((function(t){return t>=a.swatchesLimit})).hide();i.on("click",(function(){d.show(),i.hide(),n.show()})),n.on("click",(function(){d.hide(),n.hide(),i.show()}))}else i.hide();n.hide()})):this.$attributesContainer.find("[data-more], [data-less]").hide()}},e.requestAttributesChange=function(t){var e=this;if(window.FormData){var a=this.filterEmptyFilesFromForm(new FormData(t.get(0)));c.ajax({url:"/remote/v1/product-attributes/"+this.productId,method:"POST",contentType:!1,processData:!1,data:a,headers:{"stencil-config":"{}","stencil-options":"{}","x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""},xhrFields:{withCredentials:!0},success:function(t){var a=t.data,i=a.image,r=a.price;if(e.imageReplacerFunc){var n=i?i.data.replace("{:size}",e.imageSize):null;e.imageReplacerFunc(e.$cardImage,n)}else if(i){var o=i.data.replace("{:size}",e.imageSize);e.$cardImage.data("originalSrc")||e.$cardImage.data("originalSrc",e.$cardImage.attr("src")).data("originalSrcset",e.$cardImage.attr("srcset")),e.$cardImage.attr("src",o).attr("srcset","").attr("data-srcset","").addClass("productSwatches-image-optionChanged")}else e.$cardImage.data("originalSrc")&&e.$cardImage.attr("src",e.$cardImage.data("originalSrc")).attr("srcset",e.$cardImage.data("originalSrcset")).attr("data-srcset",e.$cardImage.data("originalSrcset")).data("originalSrc",null).data("originalSrcset",null).removeClass("productSwatches-image-optionChanged");if(r){var d=e.getViewModel(e.$scope);e.updatePriceView(d,r)}}})}},e.filterEmptyFilesFromForm=function(t){try{for(var e,a=function(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return u(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=t[Symbol.iterator]()).next.bind(a)}(t);!(e=a()).done;){var i=e.value,r=i[0],n=i[1];n instanceof File&&!n.name&&!n.size&&t.delete(r)}}catch(t){console.error(t)}return t},e.getViewModel=function(t){return{$priceWithTax:c("[data-product-price-with-tax]",t),$priceWithoutTax:c("[data-product-price-without-tax]",t),rrpWithTax:{$div:c(".rrp-price--withTax",t),$span:c("[data-product-rrp-with-tax]",t)},rrpWithoutTax:{$div:c(".rrp-price--withoutTax",t),$span:c("[data-product-rrp-price-without-tax]",t)},nonSaleWithTax:{$div:c(".non-sale-price--withTax",t),$span:c("[data-product-non-sale-price-with-tax]",t)},nonSaleWithoutTax:{$div:c(".non-sale-price--withoutTax",t),$span:c("[data-product-non-sale-price-without-tax]",t)},priceSaved:{$div:c(".price-section--saving",t),$span:c("[data-product-price-saved]",t)},priceNowLabel:{$span:c(".price-now-label",t)},priceLabel:{$span:c(".price-label",t)}}},e.clearPricingNotFound=function(t){t.rrpWithTax.$div.hide(),t.rrpWithoutTax.$div.hide(),t.nonSaleWithTax.$div.hide(),t.nonSaleWithoutTax.$div.hide(),t.priceSaved.$div.hide(),t.priceNowLabel.$span.hide(),t.priceLabel.$span.hide()},e.updatePriceView=function(t,e){this.clearPricingNotFound(t),e.with_tax&&(t.priceLabel.$span.show(),t.$priceWithTax.html(e.with_tax.formatted)),e.without_tax&&(t.priceLabel.$span.show(),t.$priceWithoutTax.html(e.without_tax.formatted)),e.rrp_with_tax&&(t.rrpWithTax.$div.show(),t.rrpWithTax.$span.html(e.rrp_with_tax.formatted)),e.rrp_without_tax&&(t.rrpWithoutTax.$div.show(),t.rrpWithoutTax.$span.html(e.rrp_without_tax.formatted)),e.saved&&(t.priceSaved.$div.show(),t.priceSaved.$span.html(e.saved.formatted)),e.non_sale_price_with_tax&&(t.priceLabel.$span.hide(),t.nonSaleWithTax.$div.show(),t.priceNowLabel.$span.show(),t.nonSaleWithTax.$span.html(e.non_sale_price_with_tax.formatted)),e.non_sale_price_without_tax&&(t.priceLabel.$span.hide(),t.nonSaleWithoutTax.$div.show(),t.priceNowLabel.$span.show(),t.nonSaleWithoutTax.$span.html(e.non_sale_price_without_tax.formatted))},t}();var p=a(55825);const h=function(){function t(t){var e=void 0===t?{}:t,a=e.cardSelector,i=void 0===a?".product .card, .productCarousel-slide .card":a,n=e.productIdSelector,o=void 0===n?"[data-product-id]":n,d=e.findProductIdByImg,s=void 0!==d&&d,c=e.swatchesContainerSelector,u=void 0===c?".card-text--colorswatches":c,l=e.cardImageSelector,p=void 0===l?".card-image":l,h=e.addToCartFormSelector,m=void 0===h?"form[data-cart-item-add]":h,f=e.productViewFile,v=void 0===f?"products/product-view":f,g=e.attributesTemplate,w=void 0===g?'\n            <div class="productSwatches-attributes">\n                {{#attributes}}\n                    <div class="productSwatches-swatches" data-swatches>\n                        {{#.}}\n                            <a href="#" class="productSwatches-swatches-item" title="{{label}}"\n                                data-attribute-id="{{attributeId}}"\n                                data-attribute-value="{{attributeValue}}">{{&content}}</a>\n                        {{/.}}\n                        <button type="button" class="productSwatches-swatches-more" data-more>+ More</button>\n                        <button type="button" class="productSwatches-swatches-less" data-less>- Less</button>\n                    </div>\n                {{/attributes}}\n            </div>\n        ':g,b=e.templateCustomTags,S=void 0===b?null:b,y=e.imageSize,I=void 0===y?"590x590":y,$=e.inputFinderFunc,x=void 0===$?null:$,C=e.swatchesLimit,T=void 0===C?0:C,F=e.imageReplacerFunc,_=void 0===F?null:F,k=e.displayInStockOnly,O=void 0!==k&&k,L=e.autoSelectOptionValues,W=void 0===L||L,N=e.graphQLToken,V=void 0===N?"":N;this.config={cardSelector:i,productIdSelector:o,findProductIdByImg:s,swatchesContainerSelector:u,cardImageSelector:p,addToCartFormSelector:m,productViewFile:v,attributesTemplate:w,templateCustomTags:S,imageSize:I,inputFinderFunc:x,swatchesLimit:T,imageReplacerFunc:_,displayInStockOnly:O,autoSelectOptionValues:W,graphQLToken:V},this.onWindowScroll=r()(this.onWindowScroll.bind(this,null),200),this.bindEvents()}var e=t.prototype;return e.bindEvents=function(){var t=this;p(window).on("scroll resize load",this.onWindowScroll);var e=window.MutationObserver||window.WebKitMutationObserver;e&&(this.mutationObserver=new e((function(e){var a=e.reduce((function(t,e){return[].concat(t,e.addedNodes)}),[]);t.onWindowScroll(a)})),this.mutationObserver.observe(document.documentElement,{childList:!0,subtree:!0}))},e.unbindEvents=function(){p(window).off("scroll resize load",this.onWindowScroll),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null)},e.onWindowScroll=function(t){var e=this;void 0===t&&(t=null);var a=[];if(p(this.config.cardSelector,t).each((function(t,i){var r=p(i);if(!r.data("productSwatchesCard")&&o().is(i)){var n=r.find(e.config.productIdSelector).data("productId");if(!n){if(!e.config.findProductIdByImg)return;if(!(n=r.find("img").get().reduce((function(t,e){if(t)return t;var a=String(e.src).match(/products\/([0-9]+)\//);return a?Number(a[1]):t}),null)))return}var d=r.find(e.config.swatchesContainerSelector);if(0!==d.length){var s=e.config,c=s.productViewFile,u=s.attributesTemplate,h=s.templateCustomTags,m=s.addToCartFormSelector,f=s.imageSize,v=s.inputFinderFunc,g=s.swatchesLimit,w=s.imageReplacerFunc,b=s.displayInStockOnly,S=s.autoSelectOptionValues,y=s.graphQLToken,I=r.find(e.config.cardImageSelector).first(),$=new l({$scope:r,$attributesContainer:d,productId:n,productViewFile:c,attributesTemplate:u,templateCustomTags:h,addToCartFormSelector:m,$cardImage:I,imageSize:f,inputFinderFunc:v,swatchesLimit:g,imageReplacerFunc:w,displayInStockOnly:b,autoSelectOptionValues:S,autoInit:!y});a.push($),r.data("productSwatchesCard",$),r.addClass("productSwatchesLoaded")}}})),this.config.graphQLToken&&a.length>0){var i=a.map((function(t){return t.productId}));p.ajax({url:"/graphql",method:"POST",data:JSON.stringify({query:"\n                        query {\n                            site {\n                                products (entityIds: "+JSON.stringify(i)+", first: "+i.length+") {\n                                    edges {\n                                        node {\n                                            entityId\n                                            name\n                                            minPurchaseQuantity\n                                            productOptions {\n                                                edges {\n                                                    node {\n                                                        entityId\n                                                        displayName\n                                                        ... on CheckboxOption {\n                                                            checkedByDefault\n                                                        }\n                                                        ... on MultipleChoiceOption {\n                                                            values {\n                                                                edges {\n                                                                    node {\n                                                                        entityId\n                                                                        isDefault\n                                                                        ... on SwatchOptionValue {\n                                                                            label\n                                                                            hexColors\n                                                                            imageUrl(width: 100)\n                                                                        }\n                                                                    }\n                                                                }\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    "}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.config.graphQLToken},xhrFields:{withCredentials:!0},success:function(t){t.data.site.products.edges.forEach((function(t){a.filter((function(e){return e.productId==t.node.entityId})).forEach((function(e){e.graphQLNode=t.node,e.init()}))}))}})}},t}()}}]);